\section{Data tagging}
\label{sec:tagging}

\begin{table*}
	\cstarta
	\centering
	\caption{\cstarta Tags that are considered in this paper.\cenda}
	\label{tab:tags}
	\begin{tabular}{llll}
		\toprule
		Subject & Description & Section & Possible tags \\ \otoprule
		Ego vehicle & Longitudinal activity & \cref{sec:longitudinal ego} & Accelerating, decelerating, cruising \\
		Ego vehicle & Lateral activity & \cref{sec:lateral ego} & Changing lane left, changing lane right, following lane \\
		Any other vehicle & Longitudinal activity & \cref{sec:longitudinal other vehicles} & Accelerating, braking, cruising \\
		Any other vehicle & Lateral activity & \cref{sec:lateral other vehicles} & Changing lane left, changing lane right, following lane \\
		Any other vehicle & Longitudinal state & \cref{sec:longitudinal state other vehicle} & In front of ego, behind ego \\
		Any other vehicle & Lateral state & \cref{sec:lateral state other vehicle} & Left of ego, right of ego, same lane as ego, unclear \\
		Any other vehicle & Lead vehicle & \cref{sec:lead vehicle} & Leader, no leader \\
		Static environment & On highway & \cref{sec:static environment} & Highway, no highway \\ 
		\bottomrule
	\end{tabular}
	\cenda
\end{table*}

\cstarta
Our method of scenario mining is divided into two steps. 
The first step consists in describing the data using \emph{tags} and the second step involves extracting the scenarios based on these tags. 
In this section, we explain how the \emph{tags} are determined. 
The scenario mining based on these tags is explained in the next section.

As described in \cref{def:scenario}, events and activities are constituents of a scenario. 
Part of the tags that we consider describe activities of the vehicles.
Therefore, we will use the definition of the term \emph{activity} of \autocite{degelder2018ontology}:\cenda
\begin{definition}[Activity \autocite{degelder2018ontology}]
	\label{def:activity}
	An activity quantitatively describes the time evolution of one or more state variables of an actor between two events.
\end{definition}
Because an activity starts and ends with an event, for describing the activities, we will first describe how we detect the events.

\cstarta
As an illustration, \cref{tab:tags} lists the tags that are considered for the case study in this paper. 
We distinguish between tags that describe the behavior of the ego vehicle, tags that describe the behavior and the state of any other vehicle, and tags that describe the static environment. \cenda
\begin{remark}
	\cstarta The tags in \cref{tab:tags} are sufficient for mining the scenarios of the scenario categories that we consider in our case study, see \cref{sec:case study}. However, when other scenario categories are considered, other tags might be necessary. The approach for mining the scenarios using the tags, however, is general and also applies when other tags are used. \cenda 
	\cstartc For example, for this paper we do not consider other road users than vehicles, but the proposed method also works if cyclists or pedestrians are considered.\cendc
\end{remark}

In the remainder of this section, we explain how the tags of \cref{tab:tags} are determined. 
Here, we assume that the data is sampled with a sample time of $\sampletime$.



\subsection{Longitudinal activity of the ego vehicle}
\label{sec:longitudinal ego}

We distinguish between three different longitudinal activities: ``accelerating'', ``decelerating'', and ``cruising''. 
The ego vehicle is performing either one of these activities. 
%To extract the activities from a dataset, we first extract the events.
\cstartc An acceleration activity starts at an acceleration event, so we will first describe how we detect an acceleration event.
\cendc

\cstarta To extract the longitudinal events, we might simply examine whether the acceleration of the vehicle is above or below a certain threshold. 
This approach, however, would be prone to sensor noise. 
That is why we use the speed difference within a certain sample window of length $\samplehorizon>0$, where $\samplehorizon$ is an integer.
Let $\speed{\sample}$ denote the speed of the ego vehicle at sample step $\sample$. 
Next, let us define the minimum and maximum speed between the current sample step $\sample$ and $\sample-\samplehorizon$:
\begin{align}
	\speedmin{\sample} &\defsym \min_{\sampledummy \in \left\{ \sample-\samplehorizon, \ldots, \sample \right\} } \speed{\sampledummy}, \\
	\speedmax{\sample} &\defsym \max_{\sampledummy \in \left\{ \sample-\samplehorizon, \ldots, \sample \right\} } \speed{\sampledummy}.
\end{align}\cenda
For detecting acceleration and decelerating events, the difference between the current speed and $\speedmin{\sample}$ and $\speedmax{\sample}$ are used:
\begin{align}
	\speedinc{\sample} &\defsym \speed{\sample} - \speedmin{\sample},\\
	\speeddec{\sample} &\defsym \speed{\sample} - \speedmax{\sample}.
\end{align}
\cstartd \Cref{fig:explain symbols} illustrates how $\speedmin{\sample}$, $\speedmax{\sample}$, $\speedinc{\sample}$, and $\speeddec{\sample}$ are calculated.
\cendd

\setlength{\figurewidth}{.9\linewidth}
\setlength{\figureheight}{.6\linewidth}
\begin{figure}
	\centering
	\input{figures/explain_symbols.tikz}
	\caption{\cstartd An example of a speed profile and how the variables $\speedmin{\sample}$, $\speedmax{\sample}$, $\speedinc{\sample}$, and $\speeddec{\sample}$ are calculated at a certain sample step $\sample$ with $\samplehorizon=10$.\cendd}
	\label{fig:explain symbols}
\end{figure}

First, we assume that the event at the start of the dataset is a cruising event at $\sample=\sampleinit$. Next, we go chronologically through the dataset. An acceleration event is happening at sample $\sample$ if any of the following conditions is true:
\begin{itemize}
	\item The vehicle is not performing an acceleration activity, i.e., the last event is not an acceleration event.
	\item \cstarta There has been a substantial speed increase between sample step $\sample-\samplehorizon$ and $\sample$, i.e., 
	\begin{equation}
		\label{eq:start acceleration}
		\speedinc{\sample} \geq \accelerationstart\samplehorizon\sampletime,
	\end{equation} \cenda
	where $\accelerationstart>0$ is a parameter.
	\item There is no lower speed in the near future, i.e.,
	\begin{equation}
		\label{eq:acceleration condition}
		\speedmin{\sample+\samplehorizon}=\speed{\sample}.
	\end{equation}
	\item There is a substantial speed difference during the activity, i.e., 
	\begin{equation}
		\label{eq:end acceleration condition}
		\left|\speed{\sampleendinc{\sample}} - \speed{\sample}\right| > \speeddiff,
	\end{equation}
	where \cstartc $\speeddiff>0$ is the minimum speed increase and \cendc $\sampleendinc{\sample}$ is controlled by the parameter $\accelerationcruise$ and \cstarta equals the first sample at which the speed increase is below a threshold\cenda:
	\begin{equation}
		\label{eq:end acceleration}
		\sampleendinc{\sample} \defsym \arg \min_{\sampledummy > \sample} \left\{ \sampledummy: \speedinc{\sampledummy+\samplehorizon} < \accelerationcruise\samplehorizon\sampletime \right\}.
	\end{equation}
\end{itemize}

\cstartd
A deceleration event is detected in a similar manner as an acceleration event. To detect a deceleration event, $-\speeddec{\cdot}$ substitutes $\speedinc{\cdot}$ in \cref{eq:start acceleration} and $\speedmin{\cdot}$ is substituted by $\speedmax{\cdot}$ in \cref{eq:acceleration condition}. Furthermore, $\sampleendinc{\cdot}$ in \cref{eq:end acceleration condition} is substituted by $\sampleenddec{\cdot}$, which is defined in a similar manner as $\sampleendinc{\cdot}$ in \cref{eq:end acceleration} but with $-\speeddec{\cdot}$ instead of $\speedinc{\cdot}$.\cendd

%A deceleration event is happening at sample $\sample$ if any of the following conditions is true:
%\begin{itemize}
%	\item The vehicle is not performing a decelerating activity, i.e., the last event is not a decelerating event.
%	\item \cstarta There has been a significant speed decrease, i.e., 
%	\begin{equation}
%		\label{eq:start deceleration}
%		\speeddec{\sample} \leq -\accelerationstart\samplehorizon\sampletime.
%	\end{equation} \cenda
%	\item There is no lower speed in the near future, i.e., $\speedmax{\sample}=\speed{\sample}$.
%	\item There is a significant speed difference during the activity, i.e., 
%	\begin{equation}
%		\speed{\sampleenddec{\sample}} - \speed{\sample} < -\speeddiff,
%	\end{equation}
%	with
%	\begin{equation}
%		\label{eq:end deceleration}
%		\sampleenddec{\sample} \defsym \arg \min_{\sampledummy > \sample} \left\{ \sampledummy\colon \speeddec{\sampledummy+\samplehorizon} > -\accelerationcruise\samplehorizon\sampletime \right\}.
%	\end{equation}
%\end{itemize}

Let $\sampleaccevent$ and $\sampledecevent$ denote the sample step of the most recent acceleration and decelerating event, respectively. A cruising event happens at sample step $\sample$ if the vehicle is not performing a cruising activity and if any of the following conditions is true:
\begin{itemize}
	\item $\sample > \sampleendinc{\sampleaccevent}$ when the vehicle is performing an acceleration activity.
	\item $\sample > \sampleenddec{\sampledecevent}$ when the vehicle is performing a decelerating activity.
\end{itemize}

\cstarta%
\Cref{fig:longitudinal activities} illustrates the longitudinal activities given a hypothetical speed profile (solid red line). The algorithm above described produces the activities ``cruising'', ``accelerating'', ``cruising'', ``decelerating'', and ``cruising''.
\cenda

\setlength{\figurewidth}{\linewidth}
\setlength{\figureheight}{0.7\linewidth}
\begin{figure}
	\centering
	\input{figures/lon_activities.tikz}
	\caption{\cstarta Hypothetical speed profile and the corresponding activities cruising (c), accelerating (a), and decelerating (d). The black vertical lines represent the events times. The red solid line indicates the speed $\speed{\sample}$. The green dashed line and blue dotted line represent $\speedinc{\sample}$ and $\speeddec{\sample}$, respectively.\cenda}
	\label{fig:longitudinal activities}
\end{figure}

A result of the activity detection could be very short cruising activities, especially when the acceleration is around $\accelerationcruise$ or $-\accelerationcruise$. 
Therefore, all cruising activities shorter than $\samplescruising$ sample steps are removed as well as the two events that define the start and the end of the cruising activity. 
Here, we consider three possibilities:
\begin{enumerate}
	\item Before and after the cruising activity, the vehicle performs the same activity. In that case, these activities are merged.
	\item The vehicle decelerates before the cruising activity and accelerates afterwards. In that case, an acceleration event is defined at the lowest speed of the vehicle within the original cruising activity.
	\item The vehicle accelerates before the cruising activity and decelerates afterwards. In that case, a deceleration event is defined at the highest speed of the vehicle within the original cruising activity.
\end{enumerate}



\subsection{Lateral activity of the ego vehicle}
\label{sec:lateral ego}

We distinguish between three different lateral activities: ``following lane'', ``changing lane left'', and ``changing lane right''. 
To detect the lane changes, the lateral distances toward the left and right lane lines are used. 
These distances are estimated from camera images. 
The estimation is outside the scope of this paper. 
Let $\lineleft{\sample}$ and $\lineright{\sample}$ denote the distance toward the left and right lane line, respectively. 
%In case the distances cannot be accurately estimated, the notation $\lineleft{\sample}=\nan$ and $\lineright{\sample}=\nan$ is used, where $\nan$ stands for Not-a-Number.
\cstarta We use the ISO coordinate system\cenda\cstartc\footnote{\cstartc In the ISO coordinate system \autocite{iso8855}, the $x$-axis points to the front of the vehicle and the $y$-axis points to the left of the vehicle.\cendc\cstartd The origin of the coordinate system is often at the ground below the midpoint of the rear axle.\cendd}\cendc\cstarta, so $\lineleft{\sample} \geq 0$ and $\lineright{\sample} \leq 0$. 
At the moment the vehicle crosses the line, the distances to the lines will change substantially. 
For example, during a lane change to the left, the left lane line becomes the right lane line. 
Hence, we detect a left lane change \cstartd if the change in the lane line distances is more than the threshold $\lanechangethreshold>0$\cendd:
\begin{align}
	\lineleft{\sample} - \lineleft{\sample-1} &> \lanechangethreshold, \label{eq:potential left a} \\
	\lineright{\sample} - \lineright{\sample-1} &> \lanechangethreshold. \label{eq:potential left b}
\end{align}
Similarly, a right lane change is detected when the following conditions are satisfied:
\begin{align}
	\lineleft{\sample} - \lineleft{\sample-1} &< -\lanechangethreshold, \label{eq:potential right a}\\
	\lineright{\sample} - \lineright{\sample-1} &< -\lanechangethreshold. \label{eq:potential right b}
\end{align}

Once a lane change is detected using \cref{eq:potential left a,eq:potential left b,eq:potential right a,eq:potential right b}, the moment at which the lane change starts is determined. To do this, we make use of $\lineleftinc{\sample}$ and $\lineleftdec{\sample}$, which are similarly defined as $\speedinc{\sample}$ and $\speeddec{\sample}$, i.e.,
\begin{align}
	\lineleftinc{\sample} \defsym \lineleft{\sample} - \min_{\sampledummy \in \left\{\sample-\samplehorizon, \ldots, \sample\right\}} \lineleft{\sampledummy}, \label{eq:line left inc}\\
	\lineleftdec{\sample} \defsym \lineleft{\sample} - \max_{\sampledummy \in \left\{\sample-\samplehorizon, \ldots, \sample\right\}} \lineleft{\sampledummy}. \label{eq:line left dec}
\end{align}
Similarly, $\linerightinc{\sample}$ and $\linerightdec{\sample}$ are defined. 
If a lane change is detected at sample step $\sample$ using \cref{eq:potential left a,eq:potential left b} or \cref{eq:potential right a,eq:potential right b}, the start of this lane change is estimated in a similar manner as the start of an acceleration or deceleration activity, see \cref{eq:start acceleration}. 
The start of the lane change is at the last sample step before sample step $\sample$ at which there was not a change in either of the line distances larger than a threshold controlled by the parameter $\lanechangespeed$, i.e., for a right lane change detected at sample step $\sample$, the start is at:
\begin{equation} 
	\label{eq:start lane change right}
	\arg \max_{\sampledummy < \sample} \left\{ \sampledummy\colon \lineleftinc{\sampledummy} < \lanechangespeed\samplehorizon\sampletime \lor \linerightinc{\sampledummy} < \lanechangespeed\samplehorizon\sampletime \right\},
\end{equation}
where $\lor$ indicates that either one of the two conditions needs to be satisfied.

%The end of a lane change activity is determined in a similar manner as the end of an acceleration or deceleration activity, see \cref{eq:end acceleration}.
%In other words: 
The end of a lane change is at the sample step at which either of the lane line distances increase or decrease is below a threshold. For a right lane change, this is at
\begin{multline}
	\label{eq:end lane change right}
	\arg \min_{\sampledummy > \sample} \left\{ \sampledummy\colon \lineleftinc{\sampledummy+\samplehorizon}<\lanechangespeed\samplehorizon\sampletime \lor \right.\\
	\left. \linerightinc{\sampledummy+\samplehorizon}< \lanechangespeed\samplehorizon\sampletime \right\}
\end{multline}
For a left lane change, the start and end is defined by substituting $-\lineleftdec{\cdot}$ and $-\linerightdec{\cdot}$ for $\lineleftinc{\cdot}$ and $\linerightinc{\cdot}$, respectively, in \cref{eq:start lane change right,eq:end lane change right}.
\cenda

\setlength{\figurewidth}{\linewidth}
\setlength{\figureheight}{0.6\linewidth}
\begin{figure}
	\centering
	\input{figures/ego_lane_change.tikz}
	\caption{\cstarta The red line represents the hypothetical distance toward the left lane line $\lineleft{\sample}$ during a right lane change of the ego vehicle. The black vertical lines indicate the time instants of the events at the start and the end of the lane change. The green dashed line line represents $\lineleftinc{\sample}$.\cenda}
	\label{fig:ego lane change}
\end{figure}

\cstarta
\Cref{fig:ego lane change} illustrates a hypothetical lane change of the ego vehicle. 
It shows that the distance towards the left lane line changes when the ego vehicle crosses the line, such that the conditions \cref{eq:potential right a,eq:potential right b} are satisfied. In \cref{fig:ego lane change}, events at the start and the end of the lane change are denoted by the black vertical lines.

\begin{remark}
	It might happen that there is no accurate measurement of the lane line distances available at a certain sample step $\sample$. For example, in \cref{fig:glare}, there is no line information while the ego vehicle performs a lane change. By using the next available line distances instead of $\lineleft{\sample}$ and $\lineright{\sample}$ and the previous available line distances instead of $\lineleft{\sample-1}$ and $\lineright{\sample-1}$ in \cref{eq:potential left a,eq:potential left b,eq:potential right a,eq:potential right b}, our algorithm is still able to detect lane changes.
\end{remark}
\cenda

\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{figures/glare}
	\caption{\cstarta The ego vehicle passes a flyover during daytime while performing a lane change. This causes glare such that the distance to the lane lines are not available. 
	%By using the previous and next available measurements, our proposed method is still able to detect the lane change.
	\cenda}
	\label{fig:glare}
\end{figure}



\subsection{Longitudinal activity of other vehicle}
\label{sec:longitudinal other vehicles}

The longitudinal activities of other vehicles are estimated in a similar manner as for the ego vehicle. However, instead of the speed of the ego vehicle, $\speed{\sample}$, the speed of the other vehicles is used. The ego vehicle measures the relative speed of other vehicles. Let $\speedtargetirel{\sample}{\indextarget}$ denote the relative speed of the $\indextarget$-th vehicles at sample $\sample$. The absolute speed of other vehicles is estimated by adding $v(k)$ to the estimated relative speed:
\begin{equation}
	\speedtargetiabs{\sample}{\indextarget} = \speedtargetirel{\sample}{\indextarget} + \speed{\sample}.
\end{equation}
To compute the longitudinal activities of the $\indextarget$-th vehicle, the approach outlined in \cref{sec:longitudinal ego} is used with $\speedtargetiabs{\sample}{\indextarget}$ substituted for $\speed{\sample}$. 

\begin{remark}
	\label{rem:no target}
	\cstarta Typically, $\speedtargetirel{\sample}{\indextarget}$ is obtained by fusing the outputs of several sensors \autocite{elfring2016effective}. 
	%How this is done is out of scope of this paper. 
	If $\speedtargetirel{\sample}{\indextarget}$ is not available, e.g., because the vehicle moved out of the view of the ego vehicle's sensors, there are no activities estimated for the $\indextarget$-th vehicle at sample step $\sample$. \cenda
	\cstartc Consequently, no tags are applied for the $\indextarget$-th vehicle at sample step $\sample$. This applies for all tags of the other vehicles that are mentioned in \cref{tab:tags}.\cendc
\end{remark}



\subsection{Lateral activity of other vehicle}
\label{sec:lateral other vehicles}

\cstartc
For the lane changes of other vehicles, only the lane changes to and from the ego vehicle's lane are considered.
To detect a lane change of the $\indextarget$-th vehicle, we use the distance of the $\indextarget$-th vehicle toward the ego vehicle's left and right lane lines, denoted by $\linelefttarget{\sample}{\indextarget}$ and $\linerighttarget{\sample}{\indextarget}$, respectively\cendc\cstartd\footnote{\cstartd $\linelefttarget{\sample}{\indextarget}$ and $\linerighttarget{\sample}{\indextarget}$ are determined by subtracting the estimated lane line positions from the estimated lateral position of the $\indextarget$-th vehicle. The lane line positions are based on the estimated shape of the lane lines. For more details, we refer the reader to \autocite{elfring2016effective}.\cendd}\cendd\cstartc.
We define $\linelefttargetinc{\sample}{\indextarget}$, $\linerighttargetinc{\sample}{\indextarget}$, $\linelefttargetdec{\sample}{\indextarget}$, and $\linerighttargetdec{\sample}{\indextarget}$ similar as $\lineleftinc{\sample}$ and $\lineleftdec{\sample}$ in \cref{eq:line left inc,eq:line left dec}.

A lane change is detected if the vehicle crosses either of the two lane lines.
There are four possible ways this can happen.
For now, we consider a right lane change toward the ego vehicle's lane.
A right lane change of the $\indextarget$-th vehicle toward the ego vehicle's lane is detected at sample step $\sample$ if the vehicle is not already changing lane and
\begin{equation}
	\label{eq:detect lane change target}
	\linelefttarget{\sample-1}{\indextarget} \leq 0 \land \linelefttarget{\sample}{\indextarget} > 0,
\end{equation}
where $\land$ indicates that both of the two conditions need to be satisfied.

To determine the start of the lane change, the lateral speed should be below the threshold $\lanechangespeed$ or --- in case the vehicle changes several lanes --- the lateral movement should be above a certain threshold (controlled by $\factorgoalmax$).
Because it might happen that the lateral speed is below the threshold during the whole lane change, a minimum lateral movement is considered as well (controlled by $\factorgoalmin$). 
As a result, the start of a right lane change toward the ego vehicle's lane is estimated to occur at sample step
\begin{multline}
	\label{eq:start lane change target}
	\arg \max_{\sampledummy < \sample} \left\{ \sampledummy: \linelefttarget{\sampledummy}{\indextarget} < -\factorgoalmax\widthlanetarget{\sample}{\indextarget} \lor \right. \\
	\left. \left( \linelefttargetinc{\sampledummy}{\indextarget} < \lanechangespeed\samplehorizon\sampletime \land \linelefttarget{\sampledummy}{\indextarget} < -\factorgoalmin\widthlanetarget{\sample}{\indextarget} \right) \right\}.
\end{multline}
Here, $\widthlanetarget{\sample}{\indextarget}=\linelefttarget{\sample}{\indextarget}-\linerighttarget{\sample}{\indextarget}$ is the estimated lane width. 
The end of the same lane change is estimated, in a similar way, to occur at sample step:
\begin{multline}
	\label{eq:end lane change target}
	\arg \max_{\sampledummy > \sample} \left\{ \sampledummy: \linelefttarget{\sampledummy}{\indextarget} > \factorgoalmax\widthlanetarget{\sample}{\indextarget} \lor \right. \\
	\left. \left(\linelefttargetinc{\sampledummy+\samplehorizon}{\indextarget} < \lanechangespeed\samplehorizon\sampletime \land \linelefttarget{\sampledummy}{\indextarget} > \factorgoalmin\widthlanetarget{\sample}{\indextarget}\right) \right\}.
\end{multline}

For a right lane change from the ego vehicle's lane, $\linerighttarget{\cdot}{\indextarget}$ and $\linerighttargetinc{\cdot}{\indextarget}$ are substituted for $\linelefttarget{\cdot}{\indextarget}$ and $\linelefttargetinc{\cdot}{\indextarget}$, respectively, in \cref{eq:detect lane change target,eq:start lane change target,eq:end lane change target}. 
Similarly, for a left lane change to the ego vehicle's lane, $-\linerighttarget{\cdot}{\indextarget}$ and $-\linerighttargetdec{\cdot}{\indextarget}$ are substituted for $\linelefttarget{\cdot}{\indextarget}$ and $\linelefttargetinc{\cdot}{\indextarget}$ in \cref{eq:detect lane change target,eq:start lane change target,eq:end lane change target}.
Finally, for a left lane change from the ego vehicle's lane, $-\linelefttarget{\cdot}{\indextarget}$ and $-\linelefttargetdec{\cdot}{\indextarget}$ are substituted for $\linelefttarget{\cdot}{\indextarget}$ and $\linelefttargetinc{\cdot}{\indextarget}$ in \cref{eq:detect lane change target,eq:start lane change target,eq:end lane change target}.
\cendc



\cstartc
\subsection{Longitudinal state of other vehicle}
\label{sec:longitudinal state other vehicle}

For the longitudinal state of any other vehicle, two possibilities are considered: in front of the ego vehicle or behind the ego vehicle. 
Let the longitudinal position at sample step $\sample$ of the $\indextarget$-th vehicle relative to the ego vehicle be denoted by $\lontarget{\sample}{\indextarget}$. 
The tag ``in front of ego'' applies when $\lontarget{\sample}{\indextarget}> 0$ and the tag ``behind ego'' applies when $\lontarget{\sample}{\indextarget}\leq 0$. 



\subsection{Lateral state of other vehicle}
\label{sec:lateral state other vehicle}

Four different possibilities are considered for the lateral state of any other vehicle. 
The lateral state is based on the estimated distance of the other vehicle toward the ego vehicle's lane lines, see \cref{tab:lateral state other vehicle}. 
The situation of $\linelefttarget{\sample}{\indextarget} < 0$ and $\linerighttarget{\sample}{\indextarget} \geq 0$ would mean that the other vehicle is left of the left lane line and right of the right lane line, so it is unclear in which lane the vehicle is.
%This generally only happens when there is a large error in either $\linelefttarget{\sample}{\indextarget}$ or $\linerighttarget{\sample}{\indextarget}$ because, e.g., the other vehicle is far away from the ego vehicle.

\begin{table}
	\centering
	\caption{\cstartc Lateral state based on $\linelefttarget{\sample}{\indextarget}$ and $\linerighttarget{\sample}{\indextarget}$.\cendc}
	\label{tab:lateral state other vehicle}
	\cstartc
	\begin{tabular}{lcc}
		\toprule
		& $\linelefttarget{\sample}{\indextarget} < 0$ & $\linelefttarget{\sample}{\indextarget} \geq 0$ \\ \otoprule		$\linerighttarget{\sample}{\indextarget} < 0$ & Left of ego & Same lane as ego \\
		$\linerighttarget{\sample}{\indextarget} \geq 0$ & Unclear & Right of ego \\
		\bottomrule
	\end{tabular}
	\cendc
\end{table}



\subsection{Lead vehicle}
\label{sec:lead vehicle}

Two possibilities are considered: a vehicle is a lead vehicle (the tag ``leader'' applies) or not (the tag ``no leader'' applies). A vehicle $\indextarget$ is considered as a lead vehicle at sample step $\sample$ if all of the following conditions are satisfied:
\begin{itemize}
	\item The vehicle is in front of the ego vehicle, i.e., $\lontarget{\sample}{\indextarget}>0$.
	\item The vehicle drives in the same lane as the ego vehicle, i.e., $\linelefttarget{\sample}{\indextarget} \geq 0$ and $\linerighttarget{\sample}{\indextarget} < 0$.
	\item The time headway of the ego vehicle toward the other vehicle, i.e., $\lontarget{\sample}/\speed{\sample}$ is less than the parameter $\thw>0$.
	\item There is no other vehicle that is closer to the ego vehicle while satisfying the above conditions, i.e., $\lontarget{\sample}{\indextarget} < \lontarget{\sample}{\indextargetother}$ for all $\indextargetother$-th vehicles with $\indextargetother \ne \indextarget$ that satisfy the above conditions.
\end{itemize}
\cendc



\subsection{Static environment}
\label{sec:static environment}

\cstartc
The aspect of the static environment that is considered in this paper is whether the ego vehicle drives on the highway or not. The location of the ego vehicle, based on GPS measurements, is used to determine the road the ego vehicle is driving on based on OpenStreetMaps\footnote{\cstartc See \url{https://www.openstreetmap.org/}.\cendc}. If the road is classified as ``motorway'' (see \autocite{osm_highway} for all possibilities), the tag ``highway'' is applied. Otherwise, the tag ``no highway'' is used.
\cendc
