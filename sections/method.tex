\section{Proposed Risk Estimation Method} % Hala
\label{sec:method}

In this section we discuss the following:
\begin{enumerate}
	\item High level description of the method 
	\item calculating the probability of occurrence of a scenario based on its Events, Activities, and Conditions. This is in the context of the scenario that gives a specified temporal relation between its events and activities.
	
	We are not sure about the causal relation, but we have observed the temporal relation from data. 
	 
	\item Scenario Events $\rightarrow$ independent variables 
	\item Scenario Activities $\rightarrow$ some are dependent on each other (how to distinguish dependency?)
	\item Scenario Conditions $\rightarrow$ some activities/events may depend on these. (how to define the dependencies?)
	\item We make assumptions about the dependencies, and later validate whether the assumption was justified based on measured data. 	
	\item explaining how assumptions are being made based on data
	\item give both formulas for the two cases of dependent and independent variables. (there may be a third mixed option?)
	\item use the enumerators $i, j, k$ to make the formulas independent on the number of variables (activities, events, conditions)
\end{enumerate}

Note: We use the formula of independent variable in the case study. 





\begin{enumerate}
\item{Compare the risk of the platooning driving behavior ($R_p$)to the risk of human drivers ($R_h$) with respect to rear-end-collisions only. If $$R_p < \frac{1}{10} R_h, $$ the risk is assumed to be acceptable.}
\item{For calculating the risk of the autonomous driving behavior with respect to rear-end-collisions only, we list the relevant events as follows:
\begin{enumerate}
\item{E1: V2V Failure, for $t\in[t_{E1}, t_{E1}+\Delta t_{E1}]$}
\item{E2: Lead performs an emergency brake with $u_{L}(t)\leq u_1$ , for $t\in[t_{E2}, t_{E2}+\Delta t_{E2}]$}
\item{E3: The CACC controller of the follower vehicle reacts to the emergency brake (by braking) at $t\in[t_{E3}, t_{E3}+\Delta t_{E3}]$.}
\item{E4: Collision occurs with an impact speed higher than 10~kph.}
\end{enumerate}
}
\item{We calculate the total probability of these events to lead to a collision as:
\begin{equation}
P_{tot} = P(E1) \times P(E2|E1) \times P(E3|E2) \times P(E4|E3)
\end{equation}
Note that potentially the V2V failure will occur later than the brake action of the lead, (in which case $t_{E2}<t_{E1}$). However, since these events are independent, this does not have any consequences for the proposed approach. Also, due to its independency $ P(E2|E1)=P(E2)$.
Now, we assume that the controller will respond to it (although it may respond late, it will respond eventually), so $P(E3|E2)=1$. Further, let us assume that we can identify a convex set $\mathcal{S}$ for which all states lead to collision with an impact speed higher than 10~kph, than $P(E4|E3)=1$.  Now only the probability of states in this set needs to be calculated.
This collision set $\mathcal{S}$ includes states related to timings as well as initial conditions. We define state $x$ as
\begin{eqnarray*}
x&=&\{(t_{E1},\Delta t_{E1},u_{1},t_{E2},\Delta t_{E2},\\
&&d_i(t_{E2}),v_i(t_{E2}),a_i(t_{E2}), v_{i-1}(t_{E2}),a_{i-1}(t_{E2})) \}
\end{eqnarray*}
and $\mathcal{S} = \{x \in \mathbb{R}^9|x_L < x < x_U\}$ with $x_L \in \mathbb{R}^9$ the lower bound and $x_U \in \mathbb{R}^9$ the upper bound. }
\item{Now the risk can be calculated as $P_{tot} \times $...TODO? (ARASH)}
\end{enumerate}
