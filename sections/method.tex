\section{Proposed Risk Estimation Method} % Hala
\label{sec:method}

In this section we discuss the following:
\begin{enumerate}
	\item High level description of the method 
	\item calculating the probability of occurrence of a scenario based on its Events, Activities, and Conditions. This is in the context of the scenario that gives a specified temporal relation between its events and activities.
	
	We are not sure about the causal relation, but we have observed the temporal relation from data. 
	 
	\item Scenario Events $\rightarrow$ independent variables 
	\item Scenario Activities $\rightarrow$ some are dependent on each other (how to distinguish dependency?)
	\item Scenario Conditions $\rightarrow$ some activities/events may depend on these. (how to define the dependencies?)
	\item We make assumptions about the dependencies, and later validate whether the assumption was justified based on measured data. 	
	\item explaining how assumptions are being made based on data
	\item give both formulas for the two cases of dependent and independent variables. (there may be a third mixed option?)
	\item use the enumerators $i, j, k$ to make the formulas independent on the number of variables (activities, events, conditions)
\end{enumerate}

Note: We use the formula of independent variable in the case study. 
 
In the Hazard Analysis and Risk Assessment required by ISO 26262 standard, the estimation of Automotive Safety Integrity Level (ASIL) is calculated based on a single specific hazardous event/action (I need to add a concrete description of the event in this context). Although the operational situation in which this single event occurs as well as the operating mode are taken into account in the analysis, still the proceeding and successive events were not taken into account.       
In this paper we propose a new methods to estimate the portability of exposure of a risky situation/harm in a certain scenario based on real-life driving data. This method consider/take into account a chain of relevant activities and events that are performed by different road users, within a specific scenario, and their dependency on each other. This very much in compliance with the analysis required by SOTIF (needs more explanation). 

As explained in the previous section [ref-section], a scenario consist of:
\begin{itemize}
\item $A$: activities performed by ego vehicle and other road user(dynamic environment)
\item $C$: conditions of the scenario including Operational Design Domain (ODD) of the scenario, e.g.infrastructure, weather,lighting and geographical locations(static environment).
\end{itemize}
Let $E$ be the final event that might result in a risky situation/harm. The probability $P$ of the exposure of a harm/risk in a certain scenario is then given by 
\begin{equation}
P(E,A_1,A_2,...A_n,C_1,C_2,..,C_m)=P(E,A,C) \label{eq:secM1}
\end{equation}
where $n$ is the number of performed activities within the scenario and $m$ is the number of conditions in the same scenario.
Since the harm event $E$ depends on the performed actives and scenario conditions, to compute \ref{eq3} requires computing $P(A,C)$ first.
\begin{equation}
P(A,C)=P(A|C)\dot P(C) \label{eq:secM2}
\end{equation}

To compute the severity of a harm in similar manner different .....

\begin{enumerate}
\item{Compare the risk of the platooning driving behavior ($R_p$)to the risk of human drivers ($R_h$) with respect to rear-end-collisions only. If $$R_p < \frac{1}{10} R_h, $$ the risk is assumed to be acceptable.}
\item{For calculating the risk of the autonomous driving behavior with respect to rear-end-collisions only, we list the relevant events as follows:
\begin{enumerate}
\item{E1: V2V Failure, for $t\in[t_{E1}, t_{E1}+\Delta t_{E1}]$}
\item{E2: Lead performs an emergency brake with $u_{L}(t)\leq u_1$ , for $t\in[t_{E2}, t_{E2}+\Delta t_{E2}]$}
\item{E3: The CACC controller of the follower vehicle reacts to the emergency brake (by braking) at $t\in[t_{E3}, t_{E3}+\Delta t_{E3}]$.}
\item{E4: Collision occurs with an impact speed higher than 10~kph.}
\end{enumerate}
}
\item{We calculate the total probability of these events to lead to a collision as:
\begin{equation}
P_{tot} = P(E1) \times P(E2|E1) \times P(E3|E2) \times P(E4|E3)
\end{equation}
Note that potentially the V2V failure will occur later than the brake action of the lead, (in which case $t_{E2}<t_{E1}$). However, since these events are independent, this does not have any consequences for the proposed approach. Also, due to its independency $ P(E2|E1)=P(E2)$.
Now, we assume that the controller will respond to it (although it may respond late, it will respond eventually), so $P(E3|E2)=1$. Further, let us assume that we can identify a convex set $\mathcal{S}$ for which all states lead to collision with an impact speed higher than 10~kph, than $P(E4|E3)=1$.  Now only the probability of states in this set needs to be calculated.
This collision set $\mathcal{S}$ includes states related to timings as well as initial conditions. We define state $x$ as
\begin{eqnarray*}
x&=&\{(t_{E1},\Delta t_{E1},u_{1},t_{E2},\Delta t_{E2},\\
&&d_i(t_{E2}),v_i(t_{E2}),a_i(t_{E2}), v_{i-1}(t_{E2}),a_{i-1}(t_{E2})) \}
\end{eqnarray*}
and $\mathcal{S} = \{x \in \mathbb{R}^9|x_L < x < x_U\}$ with $x_L \in \mathbb{R}^9$ the lower bound and $x_U \in \mathbb{R}^9$ the upper bound. }
\item{Now the risk can be calculated as $P_{tot} \times $...TODO? (ARASH)}
\end{enumerate}
