\section{Ontology for scenarios}
\label{sec:ontology}

We already explained the use of an ontology in \cref{sec:why ontology}. In this section, we present our ontology for scenarios for the assessment of automated vehicles. 
We use UML for implementing the ontology, because UML focuses on describing implementation related issues, which is useful considering our Python implementation.
The ontology is formally represented through a domain model that is briefly presented in \cref{sec:domain model}. Next, in \cref{sec:domain scenario class}, we explain how a scenario class is formally represented using the domain model. Similarly, in \cref{sec:domain scenario}, we describe how a scenario is formally represented using the domain model. For more details on the domain model that is representing the ontology, see \cref{sec:appendix domain model}.



\subsection{Domain model}
\label{sec:domain model}

The classes of the domain model that are used to define a scenario and a scenario class are shown in \cref{fig:ontology classes}, where each block represents a class. The blue blocks represent the classes that are used to qualitatively describe a scenario whereas the orange blocks represent the classes that are used to quantitatively describe a scenario. 

\begin{figure}
	\centering
	\input{figures/ontology_classes.tikz}
	\caption{Schematic overview of most classes of the domain model for representing the ontology for scenarios for the assessment of automated vehicles.}
	\label{fig:ontology classes}
\end{figure}

The arrows in \cref{fig:ontology classes} represent the relations of the different classes. There are three different types of arrows. The arrows with the text ``falls into'' indicate that both a scenario and a scenario class may fall into a scenario class, as explained in \cref{sec:scenario class}. The arrows with the diamond are best described by the verb ``to have''\footnote{In UML, this is called an aggregation.}. For example, a scenario ``has'' a static environment. To be more precise: a scenario ``has'' exactly one static environment, which is indicated by the 1 at the start of the arrow. In a similar manner, a scenario ``has'' zero, one, or multiple activities, which is indicated by the symbol $\mathbb{N}$ indicating any integer number starting from 0. The third arrow denotes a subclass relation. For example, the class triggered activity is a subclass of the class activity such that the class triggered activity inherits all properties from the class activity.



\subsection{Scenario class and its attributes}
\label{sec:domain scenario class}

The blue blocks in \cref{fig:ontology classes} represent the classes that are used to model a scenario class according to the definition of a scenario class, see \cref{def:scenario class}. According to \cref{def:scenario class}, a scenario class is a qualitative description of the ego vehicle, its static environment, and its dynamic environment. The ego vehicle and the dynamic environment are qualitatively described by activity categories and actor categories. Similarly, the static environment is qualitatively described by a static environment category. 

The static environment category contains a human interpretable name and description of the static environment. Furthermore, it may contain predefined tags that are also interpretable by a software agent. 

The activity category also contains a human interpretable name of the activity and it may contain predefined tags, such as the examples shown in \cref{fig:tree vehicle activities}. Furthermore, in line with the definition of an activity, see \cref{def:activity}, the activity category includes the state.  The model that is used to describe the evolution is specified. For example, the model could be `linear' or `sinusoidal'. However, since the activity category is a qualitative description, the parameters of the model are not included.

Similar to the static environment category and the activity category, the actor category has a name and tags. Furthermore, the type of the road user is specified from a predefined list. To indicate that the actor is an ego vehicle, the tag ``Ego vehicle'' is added to the list of tags.

% Scenario class
The scenario class ``has'' a static environment category, activity categories, and actor categories. As with the other classes, a scenario class contains a name and may contain predefined tags that describe parts of the scenario that are not described by the other classes. An important attribute of the scenario class, that is not shown in \cref{fig:ontology classes}, is the list of acts. Each act is a combination of an activity category and an actor category. These acts describe which actors perform which activities. Naturally, it is possible that one actor performs multiple activities and that one activity is performed by multiple actors.

% Explain why we have these different classes
The reader might wonder why we introduce the different classes for describing a scenario class, i.e., the blue blocks, instead of only one class for modeling a scenario class. To explain this, consider the following example. We have two scenario classes that ``have'' the same static environment category. In the current domain model, a static environment category exists independently of a scenario class. As a result, when the first scenario class is, for some reason, deleted, the static environment category is not affected. Therefore, the other scenario class, which ``has'' the same static environment category is also not affected. Another reason for having the static environment category, the activity category, and the actor category is because of the quantitative counterparts, i.e., the static environment, activity, and actor (orange blocks in \cref{fig:ontology classes}), which we explain in the next section.



\subsection{Scenario and its attributes}
\label{sec:domain scenario}

The orange blocks in \cref{fig:ontology classes} represent the classes that are used to model a scenario according to the definition of a scenario, see \cref{def:scenario}. A scenario ``has'' a static environment, activities, actors, and events. It is very similar to a scenario class, as the static environment, activities, and actors are the quantitative counterparts of the static environment category, activity categories, and actor categories, just as a scenario is the quantitative counterpart of a scenario class. 

% Static environment
The static environment ``has'' a static environment category, which defines the static environment qualitatively. The most notable difference between the static environment category and the static environment, is that the static environment can have multiple properties that quantitatively define the static environment. These properties define the road layout, static weather and lighting conditions, and infrastructural elements, etc.

% Activity
According to \cref{def:activity}, an activity quantitatively describes the evolution of a state in a time interval. The state that is described by an activity is defined in the activity category that the activity ``has''. The evolution is described by a model, which is also contained by the activity category, and a set of parameters. These parameters are part of the activity. 
%Note that the model can be a time interpolation of (measured) data points, in which case the parameters are a sequence of time and state values. The time interval is defined by a duration of the activity.

% Detected and triggered activity
Two different types of activities can be defined. A detected activity describes an activity that happens at a certain fixed time. On the other hand, the starting time of a triggered activity is not defined beforehand, as the activity is triggered by a certain event. This is often used for scenario-based testing. For example, in a test with a pedestrian (dummy) that starts crossing a pedestrian crossing when the ego vehicle is within a certain distance (or time) from the pedestrian crossing, the starting time of the activity of the pedestrian (dummy), i.e., walking over the pedestrian crossing, is not defined beforehand and depends on, for example, the speed of the ego vehicle. Both the detected activity and the triggered activity are subclasses of the activity, as shown in \cref{fig:ontology classes}, which means that the detected activity and the triggered activity inherit all properties from the activity. Additionally, the detected activity ``has'' a starting time and the triggered activity ``has'' an event that triggers the activity.

% Actor
Similar as the static environment and the activity, the actor ``has'' its qualitative counterpart, the actor category. Additionally, because the actor is a quantitative description, it may have multiple properties defined, such as its size, weight, color, radar reflectivity factor, etc. The actor may have an initial state and a desired state, i.e., the goal of the actor. This is especially useful for defining a test case, that describes the objective of the ego vehicle rather than its activities.

% Event
According to \cref{def:event}, an events marks the time instant at which the system reaches a specified boundary or at which a mode transition occurs. To describe this time instant, one or more conditions are specified. For example, a condition could be that the distance of the ego vehicle and a pedestrian crossing should be less than \unit[30]{m}. For this example, the moment at which this condition is met for the first time corresponds to the event. In \cite{openscenario}, an extensive list of possible conditions is given.

% Another advantage of the blue blocks -> only one activity category for multiple activities
An advantage of having the qualitative counterparts of the static environment, the activity, and the actor is that the qualitative description can be reused. For example, there can be many different braking activities, but there needs to be only one activity category for qualitatively defining the braking activity. Here, it is assumed that all braking activities are modeled with the same model and that similar tags apply. If this is not the case, multiple activity categories need to be defined, but the number of activity categories will still be significantly lower.

% Scenario
As with the static environment, activity, and actor, the scenario is the quantitative counterpart of the scenario class. As a result, a scenario ``has'' a static environment, activities, and actors. Additionally, in compliance with \cref{def:scenario}, a scenario ``has'' events. As with a scenario class, a scenario contains a list of acts. In this case, an act is a combination of an activity and an actor.



