\section{Example: pedestrian crossing}
\label{sec:example}

To illustrate the use of the ontology, we describe a scenario using the domain model presented in \cref{sec:ontology}. The scenario is schematically shown in \cref{fig:scenario overview}. The ego vehicle is driving on the right lane of a two-lane road and a pedestrian is walking on a footway that intersects the road the ego vehicle is driving on. Both the ego vehicle and the pedestrian are initially approaching the pedestrian crossing. The ego vehicle brakes and comes to a full stop in front of the pedestrian crossing. While the ego vehicle is stationary, the pedestrian crosses the road using the pedestrian crossing. When the pedestrian has passed the ego vehicle, the ego vehicle accelerates.

\setlength{\figurewidth}{\linewidth}
\begin{figure}
	\centering
	\input{figures/example_overview.tikz}
	\caption{Schematic overview of a scenario where both the ego vehicle and a pedestrian are approaching a non-signalized pedestrian crossing. The pedestrian has priority. 
	%The origin of the coordinate system is represented by $O$. The easting and northing coordinates are denoted by $\east$ and $\north$, respectively. The angle is denoted by $\head$.
	}
	\label{fig:scenario overview}
\end{figure}

\cbstart
We first describe the scenario qualitatively using our proposed ontology. Next, the scenario is described quantitatively in \cref{sec:example quantitative}. Finally, in \cref{sec:example test case}, we show the differences if a test case is considered with a crossing pedestrian.

\subsection{Qualitative description of the pedestrian crossing}
\label{sec:example qualitative}
To describe the scenario according to the presented domain model, objects are instantiated from the classes presented in \cref{fig:ontology classes}. \Cref{fig:example qualitative} shows the objects for describing the scenario qualitatively. There are two \textit{actor categories}: one for the ego vehicle and one for the pedestrian. Four different activity categories are defined: \emph{braking}, \emph{stationary}, \emph{accelerating}, and \emph{walking straight}. The braking activity is described with the sinusoidal model of \cref{eq:sinusoidal}. The stationary activity is simply modeled using a constant, i.e.:
\cbstartc
\begin{equation} \label{eq:constant model}
	\egoacceleration(t) = 0,\ \egospeed(\inittimeb) = \egospeedinitb,
\end{equation}
with $\egospeedinitb$ being the only parameter.
Both the activities \emph{accelerating} and \emph{walking straight} are described using a linear model:
\begin{align}
	\egoacceleration(t) &= \slopeego,\ \egospeed(\inittimec) = \egospeedinitc, \label{eq:ego accelerating} \\
	\pedspeed(t) &= \slopepedestrian,\ \pednorth(\inittime) = \pednorthinit. \label{eq:pedestrian walking}
\end{align}
Here, the parameters $\slopeego$ and $\slopepedestrian$ describe the rate of change of $\egospeed$ and $\pednorth$, respectively. The parameters $\egospeedinitc$ and $\pednorthinit$ describe the initial value of $\egospeed$ and $\pednorth$, respectively.
\cbend

\begin{figure}
	\centering
	\input{figures/example_qualitative.tikz}
	\caption{The objects that are used to qualitatively describe the scenario that is schematically shown in \cref{fig:scenario overview}. The first line of each blocks shows the name (before the double colon) and the class from which the object is instantiated. The following lines show the attributes of the object with the name of the attribute before the colon and the value of the corresponding attribute after the colon.}
	\label{fig:example qualitative}
\end{figure}

\cbstart
The two \textit{actor categories}, the four \textit{activity categories}, and the \textit{static environment category}, are used by the \textit{scenario class}. The \textit{scenario class} has four acts. The first three acts assign the first three activity categories to the ego vehicle. The last act assigns the activity category \emph{Walking straight} to the pedestrian.

\subsection{Quantitative description of the pedestrian crossing}
\label{sec:example quantitative}
The objects to describe the scenario quantitatively are shown in \cref{fig:example quantitative}. The two \textit{actors} refer to the quantitative counterparts of the \textit{actor categories} in \cref{fig:example qualitative}. Initial states are listed for each \textit{actor} using the coordinate frame that is shown in \cref{fig:scenario overview}. 
%It is not necessary to describe the initial northing position of the pedestrian, because it will be described by an activity. For a similar reason, the initial speed of both actors is not included. 
Since we are describing a real-world scenario, there is no need to define desired states or goals for the actors.

\cbend
\begin{figure}
	\centering
	\input{figures/example_quantitative.tikz}
	\caption{\cbstart The objects that are used to quantitatively describe the scenario that is schematically shown in \cref{fig:scenario overview}. 
		%See \cref{fig:example qualitative} for a further explanation.\cbend
	}
	\label{fig:example quantitative}
\end{figure}
\cbstart

There are four \textit{activities} defined and each of these \textit{activities} refers to its qualitative counterpart. The \textit{activities} contain the values of the parameters as well as the start time and the duration. As described by the first \textit{activity} (\emph{ego braking}), the ego vehicle starts with a speed of \SI{8}{\meter\per\second} and brakes in \SI{4}{\second} to come to a full stop. By integrating the sinusoidal function of \cref{eq:sinusoidal} twice, it can be shown that the ego vehicle stops at \SI{4}{\meter} from the center of the pedestrian crossing. After waiting for \SI{3}{\second}, see the second \textit{activity} (\emph{ego stationary}), the ego vehicle accelerates with \SI{1.5}{\meter\per\second\square} towards a speed of \SI{7.5}{\meter\per\second}, see the third \textit{activity} (\emph{ego accelerating}). The fourth activity describes the position of the pedestrian.

The \textit{static environment} describes the main road the ego vehicle is driving on and the footway the pedestrian is walking on. The example in \cref{fig:example quantitative} shows some properties to illustrate how the static environment can be described. As mentioned in \cref{sec:scenario}, however, it is also possible to refer to another source that contains a description of (part of) the static environment, see, e.g., \cite{dupuis2010opendrive}. 

The \textit{scenario}, the last object in \cref{fig:example quantitative}, ``has'' the previously defined \textit{static environment}, \textit{actors}, and \textit{activities}. The acts are used to assign the first three \textit{activities} to the ego vehicle and the last \textit{activity} to the pedestrian. The events happen at the starts and ends of the activities. For the sake of brevity, the events itself are not defined in \cref{fig:example quantitative}. The scenario also ``has'' a start time and an end time.

\subsection{Test case with pedestrian crossing}
\label{sec:example test case}
% Differences:
% - No activities of ego vehicle
% - Initial distance further away
% - Initial speed defined (one might argue that it should not be 0)
% - Note: no additional goals like "stay in lane" and "do not collide with pedestrian". This should always be the goal, not only in this case.
% - Pedestrian walking is now a triggered activity (see also event)
% - Scenario does not describe activities of ego vehicle anymore

\cbend
\begin{figure}
	\centering
	\input{figures/example_test_case.tikz}
	\caption{\cbstartc The objects that, next to the objects \emph{Ego qualitative}, \emph{Pedestrian qualitative}, \emph{Walking straight}, and \emph{Pedestrian crossing qualitative} from \cref{fig:example qualitative} and \emph{Pedestrian} and \emph{Pedestrian crossing} from \cref{fig:example quantitative}, describe a test case that is schematically shown in \cref{fig:scenario overview}.\cbend}
	\label{fig:example test case}
\end{figure}

\cbstartd
In this example, we consider a test case based on the previously illustrated real-world scenario, see \cref{fig:scenario overview}. This text case might be used, e.g., for the assessment of a pedestrian automatic emergency braking system \cite{seiniger2015test}. \Cref{fig:example test case} shows the objects that are used to describe this test case. Additionally, the two \textit{actor categories} (\emph{ego qualitative} and \emph{pedestrian qualitative}) are shown in \cref{fig:example qualitative} and the \textit{actor} describing the pedestrian (\emph{pedestrian crossing}) is shown in \cref{fig:example quantitative}.
\cbend
\cbstart
%\Cref{fig:example test case} shows the objects that change when describing a test case instead of the scenario that is described in \cref{fig:example qualitative,fig:example quantitative}. There are five objects that are different:

The \textit{scenario class} only differs from the \textit{scenario class} shown in \cref{fig:example qualitative} in that it does not contain the \textit{activity categories} that describe the activity of the ego vehicle.

Two attributes of the quantitative description of the ego vehicle are different. First, the initial state also includes the speed, denoted by $\egospeed$, at the start of the scenario and \cbstartd the initial position is further away from the pedestrian crossing, such that the ego vehicle's driver or automation system has more time to perceive the pedestrian. 
\cbend
\cbstart
%Note that we choose for a start at rest as this is most practical when performing a test in real life. Therefore, the ego vehicle needs to accelerate to approach the pedestrian crossing, which is why the initial distance is larger (\SI{60}{\meter} instead of \SI{20}{\meter}). 
Secondly, because there are no activities defined for the ego vehicle, the desired states are defined. The goal is to reach the point \SI{80}{\meter} in front of the ego vehicle while driving with a speed of $\egospeed=\SI{8}{\meter\per\second}$.

The \textit{event} that marks the start of the walking activity of the pedestrian is triggered when the ego vehicle is \SI{2.5}{\second} away from the center of the footway, assuming that the speed of the ego vehicle is constant. In case the ego vehicle drives with a speed of $\egospeed=\SI{8}{\meter\per\second}$, this is at a distance of \SI{20}{\meter}, similar to the scenario described in \cref{fig:example quantitative}.

For the test case, the pedestrian starts walking when the corresponding event is triggered. Hence, this \textit{activity} is a \textit{triggered activity} instead of a \textit{set activity}.

As with the \textit{scenario class}, the \textit{scenario} does not contain \textit{activities} of the ego vehicle. Furthermore, the end time is set to a much larger number. The test can also end earlier if the ego vehicle reaches its destination, so the end time is an upper bound in case the ego vehicle does not manage to reach its destination.
\cbend
