# Test case generation

```{r}
install.packages("transport", dependencies=TRUE)
install.packages("ks", dependencies=TRUE)
install.packages("rdist", dependencies=TRUE)
```
```{r}
require("transport")
require("ks")
require("rdist")
```

```{r}
# Load data
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
data <- read.csv("tcg_leaddec.csv")

Nz = round(dim(data)[1] / 4)
N = dim(data)[1] - Nz
Nw = 10000
```

```{r}
score <- function(generated, data) {
    A <- wpp(generated, rep(1/dim(generated)[1], dim(generated)[1]))
    B <- wpp(data, rep(1/dim(data)[1], dim(data)[1]))
    wasserstein(A, B)
}
naive_approach <- function(data, n) {
    i <- sample(1:dim(data)[1], n, replace = TRUE)
    data[i,]
}
new_approach <- function(data, d, n) {
    generated <- matrix(rep(0, dim(data)[2]*n), n, dim(data)[2])
    mean <- colMeans(data)
    decomposition <- svd(data-mean, nv = d)
    U <- decomposition$u
    S <- diag(decomposition$d, length(decomposition$d))
    V <- decomposition$v
}
```
