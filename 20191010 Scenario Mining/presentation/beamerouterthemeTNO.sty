%% This is V2.0 of the TNO's beamer presentation template.
%% Developed by Arturo Tejada Ruiz, TNO, Integrated Vehicle Safety dept., Helmond
%% September 28, 2015; modified by Jeroen Ploeg because he couldn't resist the
%% temptation, May 16, 2016.
%% January 16, 2019; Roel Muller; added corporate showtotalframenumber and shownavigation options.

%% Feel free to distribute and improve these files.
%% However, please email me a copy of your modifications (arturo.tejadaruiz@tno.nl)
%% to keep a complete repository of the improvements.

%% The template consists of the following files:
%%  Style files:
%%      beamercolorthemeTNO.sty
%%      beamerthemeTNO.sty
%%      beamerouterthemeTNO.sty (requires TNOtopBannerBlue.pdf)
%%      beamerinnerthemeTNO.sty (requires TNObannerWhite.pdf and TNObannerBlack.pdf)
%%  Logos:
%%      TNOtopBannerBlue.pdf (for outer theme)
%%      TNOtopBannerWhite.pdf (for outer theme)
%%      TNObannerWhite.pdf (for inner theme)
%%      TNObannerBlack.pdf (for inner theme)
%%  Auxiliary files:
%%      print2x2.tex (print handout in a 2 x 2 layout)
%%      TNO-example.tex (example presentation)
%%      primeNumbers.jpg (used in example presentation)

%% The template is best used in 16:9 aspect ratio using PDFLATEX to compile.
%% The traditional aspect ratio of 4:3 is also available.

\mode<presentation>

%% option for placing the banner at the bottom of the page
\DeclareOptionBeamer{corporate}[true]{\def\beamer@themeTNO@corporate{#1}}
\ExecuteOptionsBeamer{corporate=false}
%% option for showing the total number of frames
\DeclareOptionBeamer{hidetotalframenumber}[true]{\def\beamer@themeTNO@hidetotalframenumber{#1}}
\ExecuteOptionsBeamer{hidetotalframenumber=false}
%% option for showing the navigation bar
\DeclareOptionBeamer{shownavigation}[true]{\def\beamer@themeTNO@shownavigation{#1}}
\ExecuteOptionsBeamer{shownavigation=false}

\ProcessOptionsBeamer

%% convert options to tex booleans
\newif\ifcorporate\csname corporate\beamer@themeTNO@corporate\endcsname
\newif\ifhidetotalframenumber\csname hidetotalframenumber\beamer@themeTNO@hidetotalframenumber\endcsname
\newif\ifshownavigation\csname shownavigation\beamer@themeTNO@shownavigation\endcsname

%% This takes care of bolding the frame titles
\usefonttheme{structurebold}

%% This installs headline and infolines for the footline
\useoutertheme{infolines}
\setbeamertemplate{headline}[default]
\setbeamertemplate{footline}[text line]{%
    \parbox{\linewidth}{\vspace*{\ifshownavigation\ifcorporate0pt\else-6pt\fi\else-6pt\fi}\textcolor{TNOgray}{\insertshorttitle\hfill\insertshortdate}%
                        \qquad\insertframenumber\ifhidetotalframenumber\else\,/\,\inserttotalframenumber\fi
                    }}

%% Insert TNO banner and frame title/subtitle
\defbeamertemplate*{frametitle}{TNO}[1][]{
    \ifshownavigation\ifcorporate\vspace{-1mm}\else\vspace{-3mm}\fi\else\vspace{3mm}\fi\ifcorporate\else%
    \centerline{\includegraphics[keepaspectratio=true, width=\paperwidth]{TNOtopBannerBlue}}\fi
    \begin{beamercolorbox}[wd=\paperwidth, ht=1.4cm, sep=0mm, leftskip=0mm]{frametitle}
        \begin{tikzpicture}
            \useasboundingbox (0,0) rectangle (\the\paperwidth,1.4);
            \ifnum\AspectR=169\relax%
                \node[anchor=west] at (0.5,0.9) {\ifcorporate%
			        \llap{%\tikz[overlay]{\draw[black](.15ex, -.3ex)-- ++(0, -0.82\paperheight);}%
			        \small\raise2pt\hbox{\donotcoloroutermaths$\pmb{\rangle\!\!\rangle\!\!\!\rangle}$}\;}%
			        \fi\insertframetitle};%
                \node[anchor=west] at (0.5,0.3) {\insertframesubtitle};%
            \else%
                \node[anchor=west] at (0.4,0.8) {\insertframetitle};%
                \node[anchor=west] at (0.4,0.25) {\insertframesubtitle};%
            \fi%
                \ifcorporate%
                    % to align with vertical bar:
                    %\node[anchor=west, inner sep=0] at (-.015\paperwidth, -0.75\paperheight)
                    %    {\includegraphics[keepaspectratio=true,width=1.025\paperwidth]{TNOtopBannerBlue}};
                    \node[anchor=west, inner sep=0] at (0, -0.75\paperheight)
                        {\includegraphics[keepaspectratio=true,width=1\paperwidth]{TNOtopBannerBlue}};%
                \fi%
        \end{tikzpicture}
    \end{beamercolorbox}
    \vspace{-3mm}%
}

\ifshownavigation
	\setbeamertemplate{headline}{%
		\begin{beamercolorbox}[ignorebg,ht=2.25ex,dp=3.75ex]{section in head/foot}
			\insertnavigation{\paperwidth}
		\end{beamercolorbox}
	}
	\setbeamercolor*{mini frame}{fg=TNOblue,bg=TNOgray}
	\setbeamertemplate{mini frame in other section}[default][0]
	\setbeamertemplate{mini frame in other subsection}[default][0]
	\setbeamercolor{section in head/foot}{parent=palette tertiary, fg=TNOblue}
	\setbeamertemplate{section in head/foot shaded}{\color{TNOgray}\usebeamertemplate{section in head/foot}}
\fi

\mode<all>
