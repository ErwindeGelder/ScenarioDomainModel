\section{Introduction}
\label{sec:introduction}

\ac{kde} \autocite{parzen1962estimation, rosenblatt1956remarks} is a technique for estimating a \ac{pdf}. 
It is often referred to as a non-parametric way to estimate the \ac{pdf}, because no use is made of a predefined \ac{pdf} for which certain parameters are fitted to the data. 

Sampling from \iac{kde} is straightforward. 
However, in some cases, one wants to sample from the estimated \ac{pdf} while a part of the random sample is fixed.
This is known as conditional sampling. 
For example, suppose we have a two dimensional estimated distribution and we want to draw samples from this distribution while the first of these two variables is equal to a predefined value. 
One approach would be to evaluate the probability density function on a grid with possible values for the second variable. 
Out of these evaluations, a cumulative distribution function can be estimated that can be used to draw samples. 
This method would be highly cumbersome, especially with higher dimensional \acp{pdf}. 
Luckily, methods exist to perform the conditional sampling on \iac{kde} if one or more variables are fixed \autocite{hyndman1996estimating, holmes2007fast}.

Whereas conditional sampling with one or more variables fixed is described in literature, we have not found a description of sampling from \iac{kde} while the variables satisfy a linear constraint. 
In this paper, we describe a method to sample from \iac{kde}, such that the samples satisfy a linear constraint. 
To do this, we first provide an algorithm to sample from \iac{kde} while one or more variables are fixed. 
To sample from \iac{kde} while the variables satisfy a linear constraint, we first perform a rotation of the variables, such that we can use the aforementioned algorithm to sample from the \iac{kde}. 

In \cref{sec:problem}, we first describe the problem in more detail.
In \cref{sec:method}, we provide for algorithms to solve this problem:
\begin{enumerate}
	\item Sampling with one or more variables fixed from \iac{kde} with a scalar bandwidth;
	\item Sampling with one or more variables fixed from \iac{kde} with a full bandwidth matrix;
	\item Sampling from \iac{kde} with a scalar bandwidth, such that the variables satisfy linear constraints;
	\item Sampling from \iac{kde} with a full bandwidth matrix, such that the variables satisfy linear constraints;
\end{enumerate}
Through an example, we illustrate the correct performance of these algorithms in \cref{sec:example}.
We conclude this paper in \cref{sec:conclusions}.
